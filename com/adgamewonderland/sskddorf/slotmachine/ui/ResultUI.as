/* * Generated by ASDT*//*klasse:			ResultUIautor: 			gerd jungbluth, adgame-wonderlandemail:			gerd.jungbluth@adgame-wonderland.dekunde:			ssk ddorferstellung: 		14.09.2005zuletzt bearbeitet:	14.09.2005durch			gjstatus:			in bearbeitung*/import mx.rpc.ResultEvent;import mx.rpc.FaultEvent;import com.adgamewonderland.agw.util.*;import com.adgamewonderland.sskddorf.slotmachine.beans.*;import com.adgamewonderland.sskddorf.slotmachine.connectors.*;import com.adgamewonderland.sskddorf.slotmachine.controllers.*;class com.adgamewonderland.sskddorf.slotmachine.ui.ResultUI extends MovieClip {	private var myPrize:Prize;	private var headline_txt:TextField;	private var message_txt:TextField;	private var legal_txt:TextField;	private var send_btn:Button;	private var finish_btn:Button;	public function ResultUI()	{		// informationen ueber gewinn		myPrize = new Prize();	}	public function init(prize:Prize ):Void	{		// informationen ueber gewinn		myPrize = prize;		// abspielen verfolgen		var follower:TimelineFollower = new TimelineFollower(this, "showResult");		// abspielen verfolgen		onEnterFrame = function() {			follower.followTimeline();		};		// abspielen		play();	}	private function showResult():Void	{		// buttons ausblenden		send_btn._visible = finish_btn._visible = false;		// uid		var uid:Number = GameController.getInstance().getUid();		// gewonnen oder nicht		var won:Boolean = (myPrize.getId() != 0);		// wenn gewonnen, in datenbank speichern		if (won) {			// speichern und gewinnbenachrichtigung versenden			GameConnector.savePrize(uid, myPrize.getId(), this, "onNumGamesLoaded");		} else {			// anzahl noch verbleibender partien laden lassen			GameConnector.getNumGames(uid, this, "onNumGamesLoaded");		}	}	public function onNumGamesLoaded(re:ResultEvent ):Void	{		// anzahl noch verbleibender spielpartien		var numgames:Number = Number(re.result);		// headline		var headline:String = "";		// message		var message:String = "";		// legal		var legal:String = "";		// gewonnen oder nicht		var won:Boolean = (myPrize.getId() != 0);		// text entsprechend		if (won) {			// headline			headline = "Herzlichen Glückwunsch!";			// message			message = "Sie haben gewonnen: " + myPrize.getType() + "\n";			message += "Eine Bestätigung über Ihren Gewinn haben wir an Ihre registrierte E-Mail-Adresse gesendet.";			// legal			legal = " Der Rechtsweg ist ausgeschlossen!";		} else {			// headline			headline = "Sie haben leider nicht gewonnen.";			// testen, ob noch spiele erlaubt			if (numgames > 0) {				// message				message = "Versuchen Sie es doch direkt noch einmal. Pro Tag haben Sie bis zu drei Versuche. ";				message += "Heute verbleib" + (numgames > 1 ? "en" : "t") + " Ihnen noch " + numgames + " Versuch" + (numgames > 1 ? "e" : "") + ".";			} else {				// message				message = "Heute verbleibt Ihnen kein Versuch mehr. Stellen Sie Ihr Glück doch morgen wieder auf die Probe.";			}		}		// testen, ob noch spiele erlaubt		if (numgames > 0) {		 	// button send		 	send_btn.onRelease = function () {		 		this._parent.finishResult();		 	};			// button einblenden			send_btn._visible = true;		} else {		 	// button finish		 	finish_btn.onRelease = function () {				this._parent.closeWindow();		 	};			// button einblenden			finish_btn._visible = true;		}		// headline		headline_txt.autoSize = "left";		headline_txt.text = headline;		// message		message_txt.text = message;		// legal		legal_txt.autoSize = "left";		legal_txt.text = legal;	}	public function finishResult():Void	{		// ausblenden		gotoAndPlay("frClose");		// bandit beenden		_parent.finishBandit();	}	public function closeWindow():Void	{		// schliessen		getURL("javascript:closeWindow()", "");	}}